{"remainingRequest":"/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/node_modules/thread-loader/dist/cjs.js!/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/node_modules/babel-loader/lib/index.js!/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/src/views/booking/BookingDialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/src/views/booking/BookingDialog.vue","mtime":1675014998578},{"path":"/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/node_modules/cache-loader/dist/cjs.js","mtime":1673859901490},{"path":"/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/node_modules/thread-loader/dist/cjs.js","mtime":1673859901449},{"path":"/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/node_modules/babel-loader/lib/index.js","mtime":1673859901657},{"path":"/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/node_modules/vue-loader/lib/index.js","mtime":1673859901853}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\nimport _slicedToArray from \"/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/node_modules/@babel/runtime/helpers/builtin/es6/slicedToArray\";\nimport _objectSpread from \"/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/node_modules/@babel/runtime/helpers/builtin/es6/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Axios from \"axios\";\nexport default {\n  props: {\n    room: {\n      required: true\n    }\n  },\n  watch: {\n    room: function room(value) {\n      if (!value) return;\n      this.jquery(\"#booking-dialog\").modal();\n      this.form.tb_rooms_r_id = value.r_id;\n    }\n  },\n  computed: {\n    equipmentsItems: function equipmentsItems() {\n      var equipments = this.form.equipments;\n      if (equipments && equipments.length > 0) return equipments.filter(function (item) {\n        return item;\n      });\n      return [];\n    }\n  },\n  data: function data() {\n    return {\n      equipments: [],\n      form: {\n        tb_rooms_r_id: \"\",\n        bk_title: \"\",\n        bk_detail: \"\",\n        bk_time_start: {\n          date: \"\",\n          time: \"\"\n        },\n        bk_time_end: {\n          date: \"\",\n          time: \"\"\n        },\n        equipments: []\n      }\n    };\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    // ตรวจจับ Event การปิดหน้า Modal dialog\n    this.jquery(\"#booking-dialog\").on(\"hide.bs.modal\", function (event) {\n      _this.$emit(\"onClose\", event);\n    }); // ดึงข้อมูลอุปกรณ์ห้องประชุม\n\n    this.initialLoadEquipments();\n  },\n  methods: {\n    // บันทึกข้อมูล\n    onSubmit: function onSubmit() {\n      var _this2 = this;\n\n      this.$validator.validateAll().then(function (valid) {\n        if (!valid) return;\n\n        var requestData = _objectSpread({}, _this2.form);\n\n        requestData.bk_time_start = _this2.onMergeDatetime(requestData.bk_time_start);\n        requestData.bk_time_end = _this2.onMergeDatetime(requestData.bk_time_end);\n        requestData.equipments = _this2.equipmentsItems.map(function (item) {\n          return item.eq_id;\n        }); // ส่งข้อมูลไปยัง Server\n\n        Axios.post(\"/api/booking\", requestData).then(function (response) {\n          _this2.onReset();\n\n          _this2.jquery(\"#booking-dialog\").modal(\"hide\");\n        }).catch(function (err) {\n          return _this2.alertify.error(err.response.data.message);\n        });\n      });\n    },\n    // ดึงข้อมูลอุปกรณ์ห้องประชุม\n    initialLoadEquipments: function initialLoadEquipments() {\n      var _this3 = this;\n\n      Axios.get(\"/api/booking/equipments\").then(function (response) {\n        return _this3.equipments = response.data;\n      }).catch(function (err) {\n        return _this3.alertify.error(err.response.data.message);\n      });\n    },\n    // รวมวันที่กับเวลาเข้าด้วยกัน\n    onMergeDatetime: function onMergeDatetime(_ref) {\n      var date = _ref.date,\n          time = _ref.time;\n      var datetime = new Date(date);\n\n      var _time$split = time.split(\":\"),\n          _time$split2 = _slicedToArray(_time$split, 2),\n          hours = _time$split2[0],\n          minute = _time$split2[1];\n\n      datetime.setHours(hours, minute);\n      return datetime;\n    },\n    // ล้างข้อมูลจาก Form\n    onReset: function onReset() {\n      this.$validator.reset();\n      this.form = {\n        tb_rooms_r_id: \"\",\n        bk_title: \"\",\n        bk_detail: \"\",\n        bk_time_start: {\n          date: \"\",\n          time: \"\"\n        },\n        bk_time_end: {\n          date: \"\",\n          time: \"\"\n        },\n        equipments: []\n      };\n    }\n  }\n};",{"version":3,"sources":["BookingDialog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyGA,OAAA,KAAA,MAAA,OAAA;AACA,eAAA;AACA,SAAA;AACA,UAAA;AACA,gBAAA;AADA;AADA,GADA;AAMA,SAAA;AACA,QADA,gBACA,KADA,EACA;AACA,UAAA,CAAA,KAAA,EAAA;AACA,WAAA,MAAA,CAAA,iBAAA,EAAA,KAAA;AACA,WAAA,IAAA,CAAA,aAAA,GAAA,MAAA,IAAA;AACA;AALA,GANA;AAaA,YAAA;AACA,mBADA,6BACA;AACA,UAAA,aAAA,KAAA,IAAA,CAAA,UAAA;AACA,UAAA,cAAA,WAAA,MAAA,GAAA,CAAA,EACA,OAAA,WAAA,MAAA,CAAA;AAAA,eAAA,IAAA;AAAA,OAAA,CAAA;AACA,aAAA,EAAA;AACA;AANA,GAbA;AAqBA,MArBA,kBAqBA;AACA,WAAA;AACA,kBAAA,EADA;AAEA,YAAA;AACA,uBAAA,EADA;AAEA,kBAAA,EAFA;AAGA,mBAAA,EAHA;AAIA,uBAAA;AACA,gBAAA,EADA;AAEA,gBAAA;AAFA,SAJA;AAQA,qBAAA;AACA,gBAAA,EADA;AAEA,gBAAA;AAFA,SARA;AAYA,oBAAA;AAZA;AAFA,KAAA;AAiBA,GAvCA;AAwCA,SAxCA,qBAwCA;AAAA;;AACA;AACA,SAAA,MAAA,CAAA,iBAAA,EAAA,EAAA,CAAA,eAAA,EAAA,iBAAA;AACA,YAAA,KAAA,CAAA,SAAA,EAAA,KAAA;AACA,KAFA,EAFA,CAMA;;AACA,SAAA,qBAAA;AACA,GAhDA;AAiDA,WAAA;AACA;AACA,YAFA,sBAEA;AAAA;;AACA,WAAA,UAAA,CAAA,WAAA,GAAA,IAAA,CAAA,iBAAA;AACA,YAAA,CAAA,KAAA,EAAA;;AACA,YAAA,gCAAA,OAAA,IAAA,CAAA;;AACA,oBAAA,aAAA,GAAA,OAAA,eAAA,CACA,YAAA,aADA,CAAA;AAGA,oBAAA,WAAA,GAAA,OAAA,eAAA,CAAA,YAAA,WAAA,CAAA;AACA,oBAAA,UAAA,GAAA,OAAA,eAAA,CAAA,GAAA,CAAA;AAAA,iBAAA,KAAA,KAAA;AAAA,SAAA,CAAA,CAPA,CAQA;;AACA,cAAA,IAAA,CAAA,cAAA,EAAA,WAAA,EACA,IADA,CACA,oBAAA;AACA,iBAAA,OAAA;;AACA,iBAAA,MAAA,CAAA,iBAAA,EAAA,KAAA,CAAA,MAAA;AACA,SAJA,EAKA,KALA,CAKA;AAAA,iBAAA,OAAA,QAAA,CAAA,KAAA,CAAA,IAAA,QAAA,CAAA,IAAA,CAAA,OAAA,CAAA;AAAA,SALA;AAMA,OAfA;AAgBA,KAnBA;AAoBA;AACA,yBArBA,mCAqBA;AAAA;;AACA,YAAA,GAAA,CAAA,yBAAA,EACA,IADA,CACA;AAAA,eAAA,OAAA,UAAA,GAAA,SAAA,IAAA;AAAA,OADA,EAEA,KAFA,CAEA;AAAA,eAAA,OAAA,QAAA,CAAA,KAAA,CAAA,IAAA,QAAA,CAAA,IAAA,CAAA,OAAA,CAAA;AAAA,OAFA;AAGA,KAzBA;AA0BA;AACA,mBA3BA,iCA2BA;AAAA,UAAA,IAAA,QAAA,IAAA;AAAA,UAAA,IAAA,QAAA,IAAA;AACA,UAAA,WAAA,IAAA,IAAA,CAAA,IAAA,CAAA;;AADA,wBAEA,KAAA,KAAA,CAAA,GAAA,CAFA;AAAA;AAAA,UAEA,KAFA;AAAA,UAEA,MAFA;;AAGA,eAAA,QAAA,CAAA,KAAA,EAAA,MAAA;AACA,aAAA,QAAA;AACA,KAhCA;AAiCA;AACA,WAlCA,qBAkCA;AACA,WAAA,UAAA,CAAA,KAAA;AACA,WAAA,IAAA,GAAA;AACA,uBAAA,EADA;AAEA,kBAAA,EAFA;AAGA,mBAAA,EAHA;AAIA,uBAAA;AACA,gBAAA,EADA;AAEA,gBAAA;AAFA,SAJA;AAQA,qBAAA;AACA,gBAAA,EADA;AAEA,gBAAA;AAFA,SARA;AAYA,oBAAA;AAZA,OAAA;AAcA;AAlDA;AAjDA,CAAA","sourcesContent":["<template>\n    <div class=\"modal fade\" tabindex=\"-1\" role=\"dialog\" id=\"booking-dialog\">\n        <div class=\"modal-dialog\" role=\"document\">\n            <form class=\"modal-content\" @submit.prevent=\"onSubmit()\">\n                <div class=\"modal-header\">\n                    <h5 class=\"modal-title\">\n                        <i class=\"fa fa-ticket\"></i> จองห้องประชุมนี้\n                    </h5>\n                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                        <span aria-hidden=\"true\">&times;</span>\n                    </button>\n                </div>\n\n                <div class=\"modal-body\">\n                    <div class=\"form-group\">\n                        <label for=\"\">หัวข้อที่จะประชุม</label>\n                        <input type=\"text\" name=\"bk_title\"\n                            v-model.trim=\"form.bk_title\"\n                            v-validate=\"{ required: true }\"\n                            :class=\"{ 'is-invalid': errors.has('bk_title') }\"\n                            class=\"form-control\">\n                        <p class=\"invalid-feedback\">{{ errors.first('bk_title') }}</p>\n                    </div>\n\n                    <div class=\"form-group\">\n                        <label for=\"\">รายละเอียดอื่นๆ</label>\n                        <textarea \n                            v-model.trim=\"form.bk_detail\"\n                            class=\"form-control\" rows=\"4\"></textarea>\n                    </div>\n\n                    <div class=\"row\">\n                        <div class=\"col-sm-7\">\n                            <div class=\"form-group\">\n                                <label for=\"\">เริ่มประชุมวันที่</label>\n                                <input type=\"date\" name=\"bk_time_start_date\"\n                                    v-validate=\"{ required: true }\"\n                                    :class=\"{ 'is-invalid': errors.has('bk_time_start_date') }\"\n                                    v-model=\"form.bk_time_start.date\"\n                                    class=\"form-control\">\n                            </div>\n                        </div>\n                        <div class=\"col-sm-5\">\n                            <div class=\"form-group\">\n                                <label for=\"\">เวลา</label>\n                                <input type=\"time\" name=\"bk_time_start_time\"\n                                    v-validate=\"{ required: true }\"\n                                    :class=\"{ 'is-invalid': errors.has('bk_time_start_time') }\"\n                                    v-model=\"form.bk_time_start.time\"\n                                    class=\"form-control\">\n                            </div>\n                        </div>\n\n                        <div class=\"col-sm-7\">\n                            <div class=\"form-group\">\n                                <label for=\"\">สิ้นสุดประชุมวันที่</label>\n                                <input type=\"date\" name=\"bk_time_end_date\"\n                                    v-validate=\"{ required: true }\"\n                                    :class=\"{ 'is-invalid': errors.has('bk_time_end_date') }\"\n                                    v-model=\"form.bk_time_end.date\"\n                                    class=\"form-control\">\n                            </div>\n                        </div>\n                        <div class=\"col-sm-5\">\n                            <div class=\"form-group\">\n                                <label for=\"\">เวลา</label>\n                                <input type=\"time\" name=\"bk_time_end_time\"\n                                    v-validate=\"{ required: true }\"\n                                    :class=\"{ 'is-invalid': errors.has('bk_time_end_time') }\"\n                                    v-model=\"form.bk_time_end.time\"\n                                    class=\"form-control\">\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class=\"form-group mt-2\">\n                        <label for=\"\">อุปกร์สำหรับห้องประชุม</label>\n                        <div class=\"form-row\">\n                            <div class=\"col-sm-4\" v-for=\"(item, index) in equipments\" :key=\"item.eq_id\">\n                                <div class=\"form-check\" :title=\"item.eq_name\">\n                                    <label class=\"form-check-label\">\n                                        <input type=\"checkbox\" \n                                            :true-value=\"item\"\n                                            v-model=\"form.equipments[index]\"\n                                            class=\"form-check-input\"> {{ item.eq_name }}\n                                    </label>\n                                </div>\n                            </div>\n                        </div>\n\n                        <div class=\"img-equipment\" \n                            :style=\"{ 'background-image': `url(/api/uploads/${item.eq_image})` }\"\n                            :key=\"item.eq_id\" v-for=\"item in equipmentsItems\"></div>\n                    </div>\n                </div>\n\n                <div class=\"modal-footer\">\n                    <button type=\"submit\" class=\"btn btn-info btn-block mt-2 mb-4\">จองห้องประชุมนี้</button>\n                </div>\n            </form>\n        </div>\n    </div>\n</template>\n\n<script>\nimport Axios from \"axios\";\nexport default {\n  props: {\n    room: {\n      required: true\n    }\n  },\n  watch: {\n    room(value) {\n      if (!value) return;\n      this.jquery(\"#booking-dialog\").modal();\n      this.form.tb_rooms_r_id = value.r_id;\n    }\n  },\n  computed: {\n    equipmentsItems() {\n      const equipments = this.form.equipments;\n      if (equipments && equipments.length > 0)\n        return equipments.filter(item => item);\n      return [];\n    }\n  },\n  data() {\n    return {\n      equipments: [],\n      form: {\n        tb_rooms_r_id: \"\",\n        bk_title: \"\",\n        bk_detail: \"\",\n        bk_time_start: {\n          date: \"\",\n          time: \"\"\n        },\n        bk_time_end: {\n          date: \"\",\n          time: \"\"\n        },\n        equipments: []\n      }\n    };\n  },\n  mounted() {\n    // ตรวจจับ Event การปิดหน้า Modal dialog\n    this.jquery(\"#booking-dialog\").on(\"hide.bs.modal\", event => {\n      this.$emit(\"onClose\", event);\n    });\n\n    // ดึงข้อมูลอุปกรณ์ห้องประชุม\n    this.initialLoadEquipments();\n  },\n  methods: {\n    // บันทึกข้อมูล\n    onSubmit() {\n      this.$validator.validateAll().then(valid => {\n        if (!valid) return;\n        const requestData = { ...this.form };\n        requestData.bk_time_start = this.onMergeDatetime(\n          requestData.bk_time_start\n        );\n        requestData.bk_time_end = this.onMergeDatetime(requestData.bk_time_end);\n        requestData.equipments = this.equipmentsItems.map(item => item.eq_id);\n        // ส่งข้อมูลไปยัง Server\n        Axios.post(\"/api/booking\", requestData)\n          .then(response => {\n            this.onReset();\n            this.jquery(\"#booking-dialog\").modal(\"hide\");\n          })\n          .catch(err => this.alertify.error(err.response.data.message));\n      });\n    },\n    // ดึงข้อมูลอุปกรณ์ห้องประชุม\n    initialLoadEquipments() {\n      Axios.get(\"/api/booking/equipments\")\n        .then(response => (this.equipments = response.data))\n        .catch(err => this.alertify.error(err.response.data.message));\n    },\n    // รวมวันที่กับเวลาเข้าด้วยกัน\n    onMergeDatetime({ date, time }) {\n      const datetime = new Date(date);\n      const [hours, minute] = time.split(\":\");\n      datetime.setHours(hours, minute);\n      return datetime;\n    },\n    // ล้างข้อมูลจาก Form\n    onReset() {\n      this.$validator.reset();\n      this.form = {\n        tb_rooms_r_id: \"\",\n        bk_title: \"\",\n        bk_detail: \"\",\n        bk_time_start: {\n          date: \"\",\n          time: \"\"\n        },\n        bk_time_end: {\n          date: \"\",\n          time: \"\"\n        },\n        equipments: []\n      };\n    }\n  }\n};\n</script>\n\n<style scoped>\n.modal {\n  color: #525b62;\n}\n.modal-body,\n.modal-footer {\n  padding-left: 8%;\n  padding-right: 8%;\n}\n.form-check {\n  margin-bottom: 15px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.img-equipment {\n  width: 100px;\n  height: 70px;\n  border: solid 1px #d0d0d0;\n  display: inline-block;\n  margin: 1px;\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-size: contain;\n}\n</style>\n\n"],"sourceRoot":"src/views/booking"}]}