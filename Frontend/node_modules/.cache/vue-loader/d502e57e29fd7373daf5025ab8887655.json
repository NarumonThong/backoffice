{"remainingRequest":"/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/src/views/room/RoomForm.vue?vue&type=style&index=0&id=60d16de9&scoped=true&lang=css&","dependencies":[{"path":"/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/src/views/room/RoomForm.vue","mtime":1675007862082},{"path":"/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/node_modules/css-loader/index.js","mtime":1673859901298},{"path":"/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1673859901889},{"path":"/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/node_modules/postcss-loader/lib/index.js","mtime":1673859901606},{"path":"/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/node_modules/cache-loader/dist/cjs.js","mtime":1673859901490},{"path":"/Users/Projects/Vuejs/Node_Vue_BackOffice/Frontend/node_modules/vue-loader/lib/index.js","mtime":1673859901853}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.btn-menu {\n  color: #ffffff;\n  background-color: #ced4da;\n  margin-right: 7px;\n  min-width: 130px;\n}\n.btn.router-link-exact-active {\n  background-color: #D6DF23;\n}\nform {\n  max-width: 350px;\n  margin: auto;\n}\nform img {\n  border: solid 1px #6c757d;\n}\n",{"version":3,"sources":["RoomForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"RoomForm.vue","sourceRoot":"src/views/room","sourcesContent":["<template>\n    <Layout>\n        <div slot=\"buttons\" class=\"form-group\">\n            <router-link class=\"btn btn-menu\" :to=\"{ name:'room-list' }\">รายการข้อมูล</router-link>\n            <router-link class=\"btn btn-menu\" :to=\"{ name:'room-form' }\">เพิ่มข้อมูลใหม่</router-link>\n        </div>\n        <div class=\"card\">\n            <div class=\"card-body\">\n                <header>\n                    <h5><i class=\"fa fa-edit\"></i> เพิ่ม/แก้ไข ข้อมูลอุปกรณ์ห้องประชุม</h5>\n                </header>\n                <hr>\n                \n                <form @submit.prevent=\"onSubmit()\">\n                    <div class=\"form-group\">\n                        <label for=\"\">ชื่อห้องประชุม</label>\n                        <input type=\"text\" name=\"r_name\"\n                            v-model.trim=\"form.r_name\" \n                            v-validate=\"{ required: true }\"\n                            :class=\"{ 'is-invalid': errors.has('r_name') }\"\n                            class=\"form-control\">\n                        <p class=\"invalid-feedback\">{{ errors.first('r_name') }}</p>\n                    </div>\n\n                    <div class=\"form-group\">\n                        <label for=\"\">ขนาดความจุ (คน)</label>\n                        <input type=\"number\" name=\"r_capacity\"\n                            v-model.trim=\"form.r_capacity\" \n                            v-validate=\"{ required: true }\"\n                            :class=\"{ 'is-invalid': errors.has('r_capacity') }\"\n                            class=\"form-control\">\n                        <p class=\"invalid-feedback\">{{ errors.first('r_capacity') }}</p>\n                    </div>\n\n                    <div class=\"form-group\">\n                        <label for=\"\">รายละเอียด</label>\n                        <textarea class=\"form-control\" v-model.trim=\"form.r_detail\" rows=\"4\"></textarea>\n                    </div>\n\n                    <div class=\"form-group\">\n                        <label class=\"btn btn-secondary btn-block\">\n                            <i class=\"fa fa-upload\"></i> อัพโหลดภาพ\n                            <input type=\"file\" class=\"d-none\" @change=\"onChangeFile($event.target)\">\n                        </label>\n\n                        <img class=\"img-fluid\" :src=\"form.r_image || '/img/no-image.png'\" alt=\"image example\">\n                    </div>\n\n                    <div class=\"form-group mt-4 mb-5\">\n                        <div class=\"row\">\n                            <div class=\"col-sm-6\">\n                                <button type=\"submit\" class=\"btn btn-info btn-block\">\n                                    บันทึกข้อมูล\n                                </button>\n                            </div>\n                            <div class=\"col-sm-6\">\n                                <router-link :to=\"{ name: 'room-list' }\" class=\"btn btn-danger btn-block\">\n                                    ยกเลิก\n                                </router-link>\n                            </div>\n                        </div>\n                    </div>\n                </form>\n            </div>\n        </div>\n    </Layout>\n</template>\n\n<script>\nimport Layout from \"@/components/Layout\";\nimport Axios from \"axios\";\nexport default {\n  components: {\n    Layout\n  },\n  data() {\n    return {\n      form: {\n        r_name: \"\",\n        r_image: \"\",\n        r_capacity: \"\",\n        r_detail: \"\"\n      }\n    };\n  },\n  mounted() {\n    this.initialUpdateItem();\n  },\n  watch: {\n    \"$route.query.id\"() {\n      this.form = {\n        r_name: \"\",\n        r_image: \"\",\n        r_capacity: \"\",\n        r_detail: \"\"\n      };\n      this.$validator.reset();\n    }\n  },\n  methods: {\n    // ส่งข้อมูลไปยัง Backend\n    onSubmit() {\n      this.$validator.validateAll().then(valid => {\n        if (!valid) return;\n        if (this.jquery.trim(this.form.r_image) == \"\")\n          return this.alertify.warning(\"กรุณาอัพโหลดภาพ\");\n        // ตรวจสอบว่าเป็น การแก้ไขหรือการเพิ่มใหม่\n        const updateId = this.$router.currentRoute.query.id;\n        const request = isNaN(updateId)\n          ? Axios.post(\"/api/room\", this.form) // สร้างใหม่\n          : Axios.put(`/api/room/${updateId}`, this.form); // แก้ไข\n        // ส่งข้อมูลไปหา Server\n        request\n          .then(res => this.$router.push({ name: \"room-list\" }))\n          .catch(error => this.alertify.error(error.response.data.message));\n      });\n    },\n    // เปลี่ยนไฟล์อัพโหลดเป็น Base64 string\n    onChangeFile(input) {\n      this.form.r_image = \"\";\n      if (input.files && input.files.length > 0) {\n        const file = input.files[0];\n        if (file.type.indexOf(\"image/\") >= 0) {\n          const reader = new FileReader();\n          reader.readAsDataURL(file);\n          reader.addEventListener(\"load\", () => {\n            this.form.r_image = reader.result;\n          });\n          return;\n        }\n      }\n      this.alertify.warning(\"กรุณาเลือกภาพที่จะอัพโหลด !\");\n    },\n    // นำข้อมูลจาก Server ไปใส่ใน Form เพื่อทำการ update ใหม่\n    initialUpdateItem() {\n      const id = this.$route.query.id;\n      if (isNaN(id)) return;\n      Axios.get(`/api/room/${id}`)\n        .then(res => {\n          const form = res.data;\n          this.form.r_name = form.r_name;\n          this.form.r_capacity = form.r_capacity;\n          this.form.r_image = form.r_image;\n          this.form.r_detail = form.r_detail;\n        })\n        .catch(() => this.$router.push({ name: \"room-list\" }));\n    }\n  }\n};\n</script>\n\n<style scoped>\n.btn-menu {\n  color: #ffffff;\n  background-color: #ced4da;\n  margin-right: 7px;\n  min-width: 130px;\n}\n.btn.router-link-exact-active {\n  background-color: #D6DF23;\n}\nform {\n  max-width: 350px;\n  margin: auto;\n}\nform img {\n  border: solid 1px #6c757d;\n}\n</style>\n\n"]}]}